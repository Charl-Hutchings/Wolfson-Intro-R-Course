<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Charlotte Hutchings" />


<title>WolfWorks: An Introduction to R</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  { color: #cccccc; background-color: #303030; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ffcfaf; } /* Alert */
code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #dca3a3; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #f0dfaf; } /* ControlFlow */
code span.ch { color: #dca3a3; } /* Char */
code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
code span.co { color: #7f9f7f; } /* Comment */
code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
code span.do { color: #7f9f7f; } /* Documentation */
code span.dt { color: #dfdfbf; } /* DataType */
code span.dv { color: #dcdccc; } /* DecVal */
code span.er { color: #c3bf9f; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #c0bed1; } /* Float */
code span.fu { color: #efef8f; } /* Function */
code span.im { } /* Import */
code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
code span.kw { color: #f0dfaf; } /* Keyword */
code span.op { color: #f0efd0; } /* Operator */
code span.ot { color: #efef8f; } /* Other */
code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
code span.sc { color: #dca3a3; } /* SpecialChar */
code span.ss { color: #cc9393; } /* SpecialString */
code span.st { color: #cc9393; } /* String */
code span.va { } /* Variable */
code span.vs { color: #cc9393; } /* VerbatimString */
code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">WolfWorks: An Introduction to R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Setup
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="./S00_background.html">Course Outline</a>
    </li>
    <li>
      <a href="./S00_setup.html">Course Setup</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Lessons
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="./S01_R_and_RStudio.html">R and RStudio</a>
    </li>
    <li>
      <a href="./S02_Objects_in_R.html">Objects in R</a>
    </li>
    <li>
      <a href="./S03_Data_structures_in_R.html">Data structures in R</a>
    </li>
    <li>
      <a href="./S04_Starting_with_data.html">Starting with data</a>
    </li>
    <li>
      <a href="./S05_Intro_tidyverse.html">Intro to the tidyverse</a>
    </li>
    <li>
      <a href="./S06_Data_visualisation_ggplot.html">Data visualisation with ggplot2</a>
    </li>
  </ul>
</li>
<li>
  <a href="./contact.html">Contact</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/Charl-Hutchings/RIntro">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">WolfWorks: An Introduction to R</h1>
<h4 class="author">Charlotte Hutchings</h4>

</div>


<style type="text/css">

body, td {
   font-size: 18px;
}
code.r{
  font-size: 14px;
}
pre {
  font-size: 14px
}
</style>
<p><em>This is the course handbook for WolfWorks: An introduction to R.</em></p>
<hr />
<div id="lesson-1-an-introduction-to-r-and-rstudio" class="section level1">
<h1>Lesson 1: An introduction to R and RStudio</h1>
<p>Objectives:</p>
<ol style="list-style-type: decimal">
<li>Describe the purpose of the RStudio Script, Console, Environment, and Plots panes.</li>
<li>Understand the concepts of absolute and relative file paths, and the purpose of a working directory.</li>
<li>Use the built-in RStudio help interface to search for more information on R functions.</li>
</ol>
<hr />
<div id="what-are-r-and-rstudio" class="section level2">
<h2>What are R and RStudio?</h2>
<p>The term <a href="https://www.r-project.org">R</a> refers to two things: (1) the programming language itself and (2) the software which interprets scripts written in the R language.</p>
<p>RStudio, which has now been re-branded as <a href="https://posit.co">Posit</a>, is an integrated development environment (IDE) which provides a user-friendly way to interact with the R software. To function correctly, RStudio needs R so both must be installed on your computer.</p>
<p>For additional information about RStudio please see the <a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/rstudio-ide.pdf">RStudio IDE Cheat Sheet</a>. <br> <br></p>
<div id="why-use-r" class="section level3">
<h3>Why use R?</h3>
<p>There are many benefits to using R:</p>
<ul>
<li>R scripts are written in a linear manner, which makes the steps of your data analysis clear to both you and anyone else who should need to read it</li>
<li>R code is great for reproducibility because the same results are obtained when using the same code to analyse the same data - this is increasingly a requirement for many journals and funding agencies</li>
<li>R can integrated with other tools to generate manuscripts, PDF files and websites</li>
<li>R is interdisciplinary and extensible with thousands of packages developed for specific analysis requirements e.g., image analysis, population genetics, GIS etc.</li>
<li>R works on data of all shapes and sizes - once you can use R, it will make very little difference if your working with a small dataset (&lt;100 entries) or huge dataset (millions of entries)</li>
<li>R is free, open-source and cross-platform</li>
<li>R has a large and welcoming community - lots of help is available online [see below]</li>
</ul>
<hr />
</div>
</div>
<div id="the-rstudio-ide" class="section level2">
<h2>The RStudio IDE</h2>
<p>In order to begin using R, we first need to know our way around <a href="https://posit.co">RStudio</a>. RStudio consists of four “Panes”:</p>
<ol style="list-style-type: decimal">
<li>The R <strong>console</strong> - for executing code</li>
<li>The <strong>source</strong> - for scripts and documents</li>
<li>The <strong>environment</strong> - for storing R objects from the current session</li>
<li>The <strong>files, plots &amp; help</strong> pane - various functions <br> <br> These panes can be re-organised (relative size and position) to suit your working needs. To do this you can see <code>Tools -&gt; Global Options -&gt; Pane Layout</code>. <br> <br> <strong>Some definitions</strong></li>
</ol>
<p>There is a certain terminology that is used when talking about using R. We will be using these key terms throughout the workshop:</p>
<ul>
<li>The term <em>code</em> can be used both to refer to the process of writing instructions in R and to the written instructions themselves</li>
<li>We call each individual instruction a <em>command</em></li>
<li>To tell our computer system to follow the instructions, we <em>execute</em> or <em>run</em> the <em>commands</em> <br> <br> <strong>The R console</strong></li>
</ul>
<p>By default, the R console appears in the bottom left-hand pane of your RStudio window. The console is the direct interface for the R programme. This is where commands are executed from.</p>
<p><img src="images/RStudio_console.png" width="80%" style="display: block; margin: auto;" /></p>
<p><br> We can type any command directly into the console and execute it by pressing <code>Enter</code>. Any output from the command will be displayed below it in the console. For example, we could use this area like a calculator. For example:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="dv">56</span> <span class="sc">+</span> <span class="dv">44</span></span></code></pre></div>
<pre><code>## [1] 100</code></pre>
<p>By typing our command and pressing <code>Enter</code>, we have executed the code. Below we see two pieces of information. The first and most obvious output is the answer to the mathematical query that we executed - 100. In front of this we see <code>[1]</code>. To demonstrate what this <code>[1]</code> means, let’s execute the following code:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span><span class="dv">50</span></span></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25
## [26] 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50</code></pre>
<p>This command tells R to give us all numbers between <code>1</code> and <code>50</code>, which it does. This time we have <code>[1]</code> and on the second line <code>[26]</code>. These numbers are R helping us to keep track of what number output we are looking at. This is particularly useful when the output of a command is long. R has told us that the second line starts with output number <code>26</code>.</p>
<p>If R is ready to accept commands for execution, you will see the <code>&gt;</code> prompt on the left hand side of the console. If R is in the middle of running something else and is not yet ready for more code, you will see a small red symbol appear at the top right-hand side of the pane. Once R has finished executing and is ready again, a new <code>&gt;</code> prompt will appear. In some cases you may see a <code>+</code> prompt after attempting to execute a command. This means that the code you are trying to execute is unfinished in some way, for example missing a bracket (the most common explanation). If this happens, you can either provide the missing code by typing the <code>)</code> and pressing <code>Enter</code>, or you can press <code>Esc</code> to cancel the execution, correct the code and try again.</p>
<p>To clear the console we can use <code>Control + L</code>. However, once the information stored on the console is cleared we will no longer have access to it. There is no reversing this clearance. Similarly, when we close RStudio and re-open it later, the console will automatically clear and none of our work will be saved. <br> <br></p>
<p><strong>The source and R scripts</strong></p>
<p>Since code that is written and executed directly from the console cannot be saved, RStudio provides an alternative, more reproducible way to interact with R. Instead of writing in the console, we can use a <strong>script</strong>. A script is a plain text file in which we can write code and, most importantly, save code. An R script is written in the source pane, which by default is in the top left-hand pane of your RStudio window.</p>
<p><img src="images/RStudio_scripting.png" width="80%" style="display: block; margin: auto;" /></p>
<p>We can write our commands in the script in the same way that we did when using the console. We can then save this script as a file on our computer meaning that we can open it and re-run the code to get the exact same outputs.</p>
<p>When writing code into a script, the code will not automatically be executed. Instead, we need to pass the commands to the console to be run. To do this we use <code>Control + Enter</code> (you can also use <code>Cmd + Return</code> if you are using a Mac). As before, the code is then executed from the console and any outputs will be displayed there too. This means that the outputs of our script will not be saved, but the code to generate these outputs will be.</p>
<p><strong><em>Note:</em></strong> Whilst we choose to write the bulk of our code in scripts so that it can be saved, there are some instances in which we may still want to use the console. For example, if we are just checking the name of an object (we will get onto objects in a minute) or the size of a variable (we’ll talk about variables too). Essentially, the <strong>script</strong> is for permanent code which we wish to save and re-run, the <strong>console</strong> is for temporary code which we only need in that moment. <br> <br></p>
<p><strong>The RStudio environment</strong></p>
<p>The third pane in the top right-hand corner of the RStudio window has multiple tabs. We will only discuss the <strong>Environment</strong> tab, as this is arguably the most important and widely used.</p>
<p>The Environment keeps track of R objects and variables which have been created during the RStudio session (i.e., since opening RStudio). We will discuss this more later. <br> <br></p>
<p><strong>Files, Plots &amp; Help</strong></p>
<p>The final pane that you see in the bottom right-hand side of your RStudio window again contains several tabs.</p>
<hr />
</div>
<div id="what-is-a-working-directory" class="section level2">
<h2>What is a working directory?</h2>
<p>Your working directory is the location on your computer where R will default to when reading or writing files. You can check where your current working directory is by typing <code>getwd()</code> into your console and executing.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span></code></pre></div>
<pre><code>## [1] &quot;/Users/User/repos/Wolfson_Intro_R_Website&quot;</code></pre>
<p>You can think of your working directory as a room in which R is sat. When you want R to fetch something from your computer, a data file for example, you have to give R a path to get to there and this path needs to start from where R already is i.e., your working directory. For example, if I wanted to load the “” file from within my “data” folder, I’d need to tell R to first go into “data”, then grab ““. Hence, the relative path would look like this:</p>
<p><code>"data/filename"</code> <br></p>
<p>Alternatively, if I want to access a file that is not below my working directory in the file (i.e., I need to go leave the room to find another door), I can use <code>../</code> to mean go up one level. For example, if I wanted to access another folder within “repos”, I would need to leave the “Wolfson_Intro_R” room (which is my current working directory) and enter “repos”, so my filepath would be:</p>
<p><code>"../repos"</code> <br></p>
<p>These are what we call <strong>relative file paths</strong> - the file path is given relative to our <strong>working directory</strong>. The alternative is to provide an <strong>absolute file path</strong>, which starts at the highest point in your computer system. For example, to access my “” file via an absolute path I would use:</p>
<p><code>"/Users/User/repos/Wolfson_Intro_R/data/filename"</code> <br></p>
<p>For the rest of this course we will be using relative file paths from our working directory. Make sure your working directory contains a folder called “Data” with the relevant files in. If you wish to change your working directory to the place where you have this folder, you can use <code>setwd()</code> and provide an absolute file path to where the directory should be.</p>
<hr />
</div>
<div id="getting-help-with-r" class="section level2">
<h2>Getting help with R</h2>
<p>This one-day course will introduce you to many of the key concepts that are used in R, but is far from extensive. The best way to become proficient at R is to use it - frequently. Although this may seem daunting at first, there are many places that you can turn to for help. <br> <br></p>
<p><strong>The built in RStudio help interface</strong></p>
<p>As we saw briefly above, RStudio has a <code>Help</code> tab within the bottom right-hand pane. Here you can search for key words which relate to the problem that you’re having. <br></p>
<p><strong><em>I know the name of the function I want to use, but I’m not sure how to use it</em></strong> You can use a single question mark followed by the function name to bring up the help page for that function.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>?barplot</span></code></pre></div>
<p><strong><em>I know what I want to do, but I don’t know which function to use to do it</em></strong> You can use a double question mark followed by a key word and RStudio will bring up suggestions on which function you may wish to refer to. Importantly, however, RStudio can only search for function that exist in your installed packages.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>??kruskal</span></code></pre></div>
<p><br></p>
<p><strong>Online help resources</strong></p>
<p>As with everything, if you still need help (e.g., you’re getting an error message that you do not understand) you should first turn to google. The odds are that someone else has already had this in the past.</p>
<p>Another great place to check is <a href="https://stackoverflow.com/questions/tagged/r">Stack Overflow</a> using the <code>[r]</code> tag. If you word your question well and are clear about what it is you want to do, your query will often be answered within a matter of hours.</p>
<p>If possible, to increase the chances of other people being able to understand and recreate the problem or error that you have, you should provide a small, simple and reproducible example of your problem. Information about how to do this can be found <a href="http://adv-r.had.co.nz/Reproducibility.html">here</a>. <br></p>
<hr />
</div>
</div>
<div id="lesson-2-objects-in-r" class="section level1">
<h1>Lesson 2: Objects in R</h1>
<p>Objectives:</p>
<ol style="list-style-type: decimal">
<li>Understand the key terms <em>object</em>, <em>variable</em>, <em>assign</em>, <em>call</em>, <em>function</em>, <em>argument</em>, and <em>options</em></li>
<li>Know how to store and name objects within the RStudio Environment</li>
</ol>
<hr />
<div id="assigning-values-to-objectsvariables" class="section level2">
<h2>Assigning values to objects/variables</h2>
<p>As we saw previously, we can execute code directly via the <strong>console</strong> (by pressing <code>Enter</code>) or indirectly via a <strong>script</strong> (by pressing <code>Control + Enter</code>). The output of our command will appear in the console. However, if we want to store a value or data structure, we have to <em>assign</em> it to an <em>object</em>. <br> <br></p>
<p>Some more important definitions:</p>
<ul>
<li>An <em>object</em> is a data store within R - it contains one or more values and these can be stored in various structures e.g., data frames, matrices, vectors (more about these data structures later)</li>
<li>What are known as <code>objects</code> in <code>R</code> are known as <code>variables</code> in some other programming languages. In certain scenarios the terms <em>object</em> and <em>variable</em> have very distinct meanings, but for the context of today’s workshop they are the same thing</li>
<li>To store some data within an object, we must <em>assign</em> the data to our object. This is done using the assignment operator <code>&lt;-</code> <br></li>
</ul>
<p>For example, if I wish to save the value <code>55</code> into an object called <code>weight_kg</code>, I could use the assignment operator like so:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># assign a value of 55 to a variable called weight_kg</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>weight_kg <span class="ot">&lt;-</span> <span class="dv">55</span></span></code></pre></div>
<p>When I execute this code I notice that there is no output in the console. That is because R does not print anything when assigning a value to an object. However, we do see that this object has appear in our Environment pane. If we want R to both assign the value of <code>55</code> to <code>weight_kg</code> and at the same time print its value in the console, we can add brackets around our assignment.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>(weight_kg <span class="ot">&lt;-</span> <span class="dv">55</span>)</span></code></pre></div>
<pre><code>## [1] 55</code></pre>
<p>Now R has stored <code>weight</code> in its memory, we can use the object name to represent the value we have stored.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print the value of weight</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>weight_kg</span></code></pre></div>
<pre><code>## [1] 55</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use the value of weight for arithmetic</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>weight_kg <span class="sc">*</span> <span class="fl">2.2</span></span></code></pre></div>
<pre><code>## [1] 121</code></pre>
<p>As before, the output that appears in our console is the result of the arithmetic alongside a <code>[1]</code> to indicate that this is the first (and only) value of the output. Importantly, this has not altered the value of our <code>weight_kg</code> object because we did not assign the output of this code to the object <code>weight_kg</code>. If we want to save the value of <code>weight_kg * 2.2</code> then we need to assign it to an object.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="do">## assign the output of our arithmetic query to a new object</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>weight_lb <span class="ot">&lt;-</span> weight_kg <span class="sc">*</span> <span class="fl">2.2</span></span></code></pre></div>
<p>Now I see both objects are present in my environment.</p>
<p>If we were to assign a new value to <code>weight_kg</code>, this would overwrite the previous value. Let’s try it.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>weight_kg <span class="ot">&lt;-</span> <span class="dv">62</span></span></code></pre></div>
<p><strong>Question:</strong> What are the values of <code>weight_kg</code> and <code>weight_lb</code> now. Does <code>weight_lg</code> = <code>weight_kg * 2.2</code>? <br> <br></p>
<p><strong>Naming objects in R</strong></p>
<p>Since we now know how to assign a value to an object using the <code>&lt;-</code> operator, it is worth taking a moment to consider how we should name these objects. There are some basic naming principles that you should adhere to in R:</p>
<ol style="list-style-type: decimal">
<li>Use meaningful names that relate to what is inside of the object - avoid meaningless names such as <code>a</code>, <code>b</code>, <code>c</code></li>
<li>R will not allow names with spaces in - it is common practice to replace a space with <code>_</code></li>
<li>R will not allow an object name which begins with a number - <code>2x</code> is not a valid name, but <code>x2</code> is</li>
<li>Avoid names that are the same as function names e.g., <code>if</code>, <code>else</code>, <code>mean</code>, <code>data</code> and <code>c</code></li>
<li>Avoid dots (<code>.</code>) as many function names contain dots for historical reasons</li>
</ol>
<p>You should also be aware that R is case-sensitive. This means that R does not consider <code>weight_kg</code> and <code>Weight_kg</code> to be the same thing. For more information about naming practices and writing neat code there are several R style guides e.g., the <a href="https://contributions.bioconductor.org/r-code.html#r-code">Bioconductor style guide</a> or the <a href="https://style.tidyverse.org">tidyverse guide</a>. <br> <br></p>
<p><strong>Comments</strong></p>
<p>When we are writing a script we want to be able to annotate the script with notes and explanations of what the code is doing. This helps both your future self and anyone else who should ready your script to understand what is going on.</p>
<p>The comment character in R is <code>#</code>. Anything to the right of a <code>#</code> will be ignored by R. RStudio also helps us by changing the colour of our commented text so that we can see it easily.</p>
<hr />
</div>
<div id="calling-functions" class="section level2">
<h2>Calling functions</h2>
<p>Functions are one of the key features of R. A <em>function</em> is a self-contained module of code that has been written to carry out a specific task. R has many functions that allow us to automate common tasks. For example, think about how many R users around the globe will at some point take the mean average of some data. Rather than each individual writing out the arithmetic for this, R has a convenient <code>mean</code> function that already contains all of the required code.</p>
<p>Many functions are pre-defined in R and are already here and ready for use. For more specific analysis needs, thousands more functions can be installed and used by importing R <em>packages</em> (more on that later).</p>
<p>A <em>function</em> typically requires one or more inputs called <em>arguments</em> and usually returns a value. Executing a function (i.e., running it) is referred to as <em>calling</em> the function.</p>
<p>Let’s look at a simple example, the <code>round</code> function. This function takes a number and rounds it, as indicated by the name.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="at">x =</span> <span class="fl">3.1415926</span>)</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<p>Here, we have <em>called</em> the <code>round</code> <em>function</em> and passed it the argument <code>x = 3.1415926</code>. If we want to see what the argument <code>x</code> requires, we can use the single question mark help function that we saw previously.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>?round</span></code></pre></div>
<p>This tells us that the argument <code>x</code> is a numeric vector i.e., the number that we wish to round. We can also see that there is another argument available for this function, the <code>digits</code> argument. We did not previously pass this argument because it is not an absolute requirement. Many functions have these optional arguments (called <em>options</em>) and if they are not specified they will take on a <em>default</em> value. Here, the default value for the <code>digits</code> argument is 0 (i.e., round to the nearest whole number). The default value can be overwritten by specifying this argument in our code.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="at">x =</span> <span class="fl">3.1415926</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 3.14</code></pre>
<p>In this example we have explicitly named the arguments <code>x =</code> and <code>digits =</code>. This is not always necessary in R, but it is useful when starting out. When we name the arguments, the order we provide them in does not matter because R can still tell what we are referring to. If, however, we provided our arguments without naming them, then we would have to be careful about their order.</p>
<p>There is a default order in which R expects to receive arguments for a function. If we don’t provide explicit argument names, we have to stick to the default order so that R can tell which argument is which.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pass arguments in the correct (default) order with names</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="at">x =</span> <span class="fl">3.1415926</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 3.14</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pass arguments in the correct (default) order without names</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fl">3.1415926</span>, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 3.14</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pass arguments in alternative order with names</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>, <span class="at">x =</span> <span class="fl">3.1415926</span>)</span></code></pre></div>
<pre><code>## [1] 3.14</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pass arguments in alternative order without names</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="dv">2</span>, <span class="fl">3.1415926</span>)</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<p>This is particularly important as we begin to use more complex functions that require a larger number of arguments.</p>
<p>Some useful math/stat functions in R:</p>
<ul>
<li><code>max()</code>: maximum value in a numeric vector</li>
<li><code>min()</code>: minimum value in a numeric vector</li>
<li><code>range()</code>: vector of min and max</li>
<li><code>sum()</code>: sum of a vector</li>
<li><code>mean()</code>: mean of a vector</li>
<li><code>median()</code>: median of a vector</li>
<li><code>var()</code>: variance of a vector</li>
<li><code>sd()</code>: standard deviation of a vector</li>
<li><code>sort()</code>: sorted version of a vector</li>
<li><code>length()</code>: length of an object</li>
<li><code>cor()</code>: correlation of x and y <br> <br></li>
</ul>
<p><strong>Challenge: Objects in R</strong> <br> Create two new objects called <code>mass</code> and <code>age</code> and assign the values of <code>122</code> and <code>47.5</code> to them, respectively. Now use these objects to calculate the value of a new object called <code>mass_index</code> (equal to mass divided by age).</p>
<p>Now change the value of <code>mass</code> by multiplying it by two and change the value of <code>age</code> by minusing 20. What is the value of the <code>mass_index</code> now? <br></p>
<hr />
</div>
</div>
<div id="lesson-3-data-structures-in-r" class="section level1">
<h1>Lesson 3: Data structures in R</h1>
<p>Objectives:</p>
<ol style="list-style-type: decimal">
<li>Have a basic knowledge of the key data structures used in R: <em>vectors</em>, <em>data frames</em>, and <em>matrices</em></li>
<li>Be aware of the different data types that can be stored, including <em>numeric</em>, <em>character</em> and <em>factors</em></li>
<li>Understand how to generate a <code>data.frame</code> and access information from this structure using indexing</li>
<li>Know how to identify and deal with missing data in R</li>
</ol>
<hr />
<div id="vectors-and-data-types" class="section level2">
<h2>Vectors and data types</h2>
<p>R has many structures in which data can be stored and manipulated:</p>
<ul>
<li>Vectors</li>
<li>Data frames</li>
<li>Matrices</li>
<li>Lists</li>
<li>Factors <br> <br></li>
</ul>
<p>The most common and basic of these structures is a vector, sometimes referred to as an <strong>atomic vector</strong>. Whilst vectors can be used as a structure in themselves, they are also the basic building blocks of several other data types, as we will see later. <br> <br></p>
<p>A vector is simply a collection of values. These values can any of the 6 basic data types in R:</p>
<ol style="list-style-type: decimal">
<li><strong>character</strong> = a series of letters, numbers and/or punctuation marks (a <strong>string</strong>). Always found between quotation marks (single or double) e.g., <code>"a"</code>, <code>"fish"</code>, <code>"3.14"</code>. If a number is found in quotation marks, R will interpret this data as being of type character, not numeric. This is important because R cannot then use this data in a numeric manner i.e., to carry out arithmetic.</li>
<li><strong>double</strong> = one of the two <strong>numeric</strong> data classes in R, standing for <em>double precision floating point numbers</em>. This means any real number, an integer or a decimal (10, 3.14, 1.45765, 10000, 5)</li>
<li><strong>integer</strong> = the second of the two <strong>numeric</strong> data classes in R, holding only integer values e.g., 5L (the “L” tells R to store this as an integer rather than double)</li>
<li><strong>logical</strong> = a <code>TRUE</code>, <code>FALSE</code> class</li>
<li><strong>complex</strong> = complex numbers with real and imaginary parts</li>
<li><strong>raw</strong> = holds raw bytes</li>
</ol>
<p>Data types 5 and 6 are rarely used and will not be covered in this workshop. As outlined above, <strong>numeric</strong> data in R can be stored as either <strong>double</strong> or <strong>integer</strong>. You don’t need to worry about this because R will automatically convert between these classes when required for mathemetical purposes. There is really no need to explicitly state or know which or the two <strong>numeric</strong> classes the data is. <br> <br></p>
<p>A <em>vector</em> is a collection of values <strong>of the same data class</strong>. You can visualise a vector like this:</p>
<p><img src="images/Vectors_in_R.jpeg" width="80%" style="display: block; margin: auto;" /> <br></p>
<p>To create a vector we use the <code>c()</code> function, where <code>c</code> stands for combine. We pass the function our values, each separated by “,”.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Create a numeric vector and assign to the object weight_g</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>weight_g <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">60</span>, <span class="dv">57</span>, <span class="dv">82</span>)</span></code></pre></div>
<p>This is a numeric vector. We can also create a character vector.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Create a character vector and assign to the object molecules</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>molecules <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;dna&quot;</span>, <span class="st">&quot;rna&quot;</span>, <span class="st">&quot;protein&quot;</span>)</span></code></pre></div>
<p><br></p>
<p><strong>Question:</strong> What happens if we try to create a character vector but forget to include our values in quotation marks?</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="do">## What if we forget our quotation marks?</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>molecules <span class="ot">&lt;-</span> <span class="fu">c</span>(dna, rna, protein)</span></code></pre></div>
<p><br> <br></p>
<p><strong>Exploring vectors</strong></p>
<p>There are several key functions that allow us to find out information about a vector. The <code>class()</code> and <code>length()</code> functions will tell us what data class is stored within a vector and how many data elements there are.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Check class and length of weight_g</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(weight_g)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(weight_g)</span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<p><br></p>
<p><strong>Question:</strong> What will be the outputs of <code>class</code> and <code>length</code> when we pass our <code>molecules</code> vector?</p>
<p>To get both of these pieces of information at the same time we can use the <code>str()</code> function, standing for structure.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Check the structure of weight_g</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(weight_kg)</span></code></pre></div>
<pre><code>##  num 62</code></pre>
<p><br> <br></p>
<p><strong>Indexing vectors</strong></p>
<p>Sometimes we might wish to access only certain elements of a vector. To do this we need to introduce the concept of <em>indexing</em>. The term <em>indexing</em> refers to selecting a subset of elements. To do this, we use square brackets and provide one or more indices.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Return the first element in the weight_g vector</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>weight_g[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [1] 50</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Return the third element in the weight_g vector</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>weight_g[<span class="dv">3</span>]</span></code></pre></div>
<pre><code>## [1] 57</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Return all elements between positions 1 and 3 in weight_g</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>weight_g[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="do">## Based on a sequence</span></span></code></pre></div>
<pre><code>## [1] 50 60 57</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>weight_g[<span class="sc">-</span><span class="dv">4</span>] <span class="do">## Using the minus sign to ask for all except 4</span></span></code></pre></div>
<pre><code>## [1] 50 60 57</code></pre>
<p><br></p>
<p><strong>Question:</strong> How could we index multiple elements that are not together in a sequence. For example, if I only wanted elements 1 and 3 from <code>weight_g</code>? <br></p>
<p>We can also do more complex indexing based on conditions (<strong>conditional indexing</strong>). For instance, if we wanted to return the element “rna” from our <code>molecules</code> vector but we don’t remember which position it is in.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Index all elements in molecules that are &quot;rna&quot;</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>molecules[molecules <span class="sc">==</span> <span class="st">&quot;rna&quot;</span>]</span></code></pre></div>
<pre><code>## [1] &quot;rna&quot;</code></pre>
<p>We can also do this for numeric vectors using mathematic operators. Let’s try to subset elements from our <code>weight_g</code> vector that have a value greater than 55.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Index all elements in weight_g that are &gt; 55</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>weight_g[weight_g <span class="sc">&gt;</span> <span class="dv">55</span>]</span></code></pre></div>
<pre><code>## [1] 60 57 82</code></pre>
<p>We can combine multiple conditions use the <code>&amp;</code> (and) and <code>|</code> (or) operators.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Index all elements in weight_g that are &gt; 55 and &lt; 80</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>weight_g[weight_g <span class="sc">&gt;</span> <span class="dv">55</span> <span class="sc">&amp;</span> weight_g <span class="sc">&lt;</span> <span class="dv">80</span>]</span></code></pre></div>
<pre><code>## [1] 60 57</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Index all elements in weight_g that are &gt; 55 or &lt; 80</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>weight_g[weight_g <span class="sc">&gt;</span> <span class="dv">55</span> <span class="sc">|</span> weight_g <span class="sc">&lt;</span> <span class="dv">80</span>]</span></code></pre></div>
<pre><code>## [1] 50 60 57 82</code></pre>
<p><br></p>
<p><strong>Question:</strong> What is actually happening behind the scenes when we do conditional indexing? Think about the data classes. See what happens if we execute the condition outside of the indexing.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>weight_g <span class="sc">&gt;</span> <span class="dv">55</span></span></code></pre></div>
<pre><code>## [1] FALSE  TRUE  TRUE  TRUE</code></pre>
<p><br></p>
<p><strong>Question:</strong> Why does <code>"four" &gt; "five"</code> return <code>TRUE</code>? What is happening in this conditional statement?</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;four&quot;</span> <span class="sc">&gt;</span> <span class="st">&quot;five&quot;</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p><br> <br></p>
<p><strong>Coercing vectors into a single data class</strong></p>
<p>One of the primary features of a vector is that it represents a linear collection of elements that <strong>must</strong> be of the same data class. Above we looked at both numeric and character vectors. If we try to create a vector with multiple data classes, R will automatically <strong>coerce</strong> the elements into a single data type.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Try to generate a vector with multiple data classes</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>mixed_vector <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;dna&quot;</span>, <span class="dv">12</span>, <span class="dv">45</span>, <span class="st">&quot;rna&quot;</span>, <span class="dv">77</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mixed_vector)</span></code></pre></div>
<pre><code>##  chr [1:5] &quot;dna&quot; &quot;12&quot; &quot;45&quot; &quot;rna&quot; &quot;77&quot;</code></pre>
<p>The numeric values have been coerced into character values, which we can see from (i) the <code>chr</code> and presence of quotation marks. <br></p>
<p><strong>Question:</strong> What is the hierarchy which R uses for the coercion of different data types? Try generating vectors with:</p>
<ol style="list-style-type: decimal">
<li>Character and numeric values = coerced to…</li>
<li>Character and logical values = coerced to…</li>
<li>logical and numeric values = coerced to…</li>
</ol>
<p>For more information about coercion behavior in R see <a href="https://www.zigya.com/blog/what-is-coercion-in-r/">here</a>.</p>
<p>It is important to know what data class you are dealing with because this will influence what you can and cannot do with the data. We can convert the data type of a vector to a different class using the “as” family of functions:</p>
<ul>
<li><code>as.character()</code>: convert to character type data</li>
<li><code>as.numeric()</code>: convert to numerical vector</li>
<li><code>as.integer()</code>: convert to integer vector</li>
<li><code>as.logical()</code>: convert to logical vector <br> <br></li>
</ul>
<p><strong>Vectorization in R</strong></p>
<p>Most of R’s functions are <strong>vectorized</strong> meaning that the function will operate on each element of the vector. This makes coding more concise, easier to read, and less prone to errors.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Vectorized function - function applied to all elements of a vector independently</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>weight_g <span class="sc">*</span> <span class="dv">5</span></span></code></pre></div>
<pre><code>## [1] 250 300 285 410</code></pre>
<p><br> <br></p>
<p><strong>Factor vectors</strong></p>
<p>R has a special way of dealing with categorical data - the <strong>factor</strong>. Categorical data might be something such as sex - “Male”, “Female” - or tumour stage - “Stage1”, “Stage2”, “Stage3”, etc. Critically, the possible entries, or <strong>levels</strong>, of a factor are limited.</p>
<p>While factors look and behave like character vectors, they are actually stored by R as an integer vector, so it is important to be careful with them when treating them as strings or transforming them to other data types.</p>
<p>We can convert a character vector into a factor using the <code>factor()</code> function. Let’s try this with our <code>molecules</code> vector.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Convert molecules vector into a factor</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>molecules <span class="ot">&lt;-</span> <span class="fu">factor</span>(molecules)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Check structure</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(molecules)</span></code></pre></div>
<pre><code>##  Factor w/ 3 levels &quot;dna&quot;,&quot;protein&quot;,..: 1 3 2</code></pre>
<p>We now have a factor with each category stored as a level. As mentioned above, R treats the levels of a factor as integers, here 1, 2 and 3. These integers are assigned to the levels alphabetically, which is not necessarily the order in which we specified them. We can check the order of our levels using the <code>levels()</code> function.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Check levels</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(molecules)</span></code></pre></div>
<pre><code>## [1] &quot;dna&quot;     &quot;protein&quot; &quot;rna&quot;</code></pre>
<p>These are returned in alphabetical order. For plotting or statistical analysis, the order of the levels will sometimes matter. If we want to re-order the levels of a factor we can make use of the <code>levels</code> argument of the <code>factor()</code> function.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Create a factor and specify level order</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>molecules <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="at">x =</span> molecules, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;dna&quot;</span>, <span class="st">&quot;rna&quot;</span>, <span class="st">&quot;protein&quot;</span>))</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Check</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(molecules)</span></code></pre></div>
<pre><code>## [1] &quot;dna&quot;     &quot;rna&quot;     &quot;protein&quot;</code></pre>
<p>Alternatively, we can over-write the pre-existing levels of a factor like so:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Re-order the levels of a factor</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(molecules) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;protein&quot;</span>, <span class="st">&quot;dna&quot;</span>, <span class="st">&quot;rna&quot;</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Check</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(molecules)</span></code></pre></div>
<pre><code>##  Factor w/ 3 levels &quot;protein&quot;,&quot;dna&quot;,..: 1 2 3</code></pre>
<p>Factor vectors can be converted back to numeric or character classes using the <code>as.numeric()</code> and <code>as.character()</code> functions. <br> <br></p>
<p><strong>Challenge: Vectors in R</strong> <br> Create a new vector called <code>heights</code> with the following values: 63, 69, 60, 65, NA, 68, 61, 70, 64, NA, 72, 65. Use the <code>median()</code> function to determine the median of these values. Remember that you can use <code>?median</code> to ask for help using this function. After this, use R to determine how many people in the set are taller than 67 inches.</p>
<hr />
</div>
<div id="data-frames" class="section level2">
<h2>Data frames</h2>
<p>Vectors are arguably the most important base structure in R. However, most of the time we want to store multiple data variables of different data types in a single object. That is where data frames come in. A <em>data frame</em> is a simple tabular structure in which the columns are vectors of the same length. Since a data frame contains multiple vectors it is able to store data of multiple different classes.</p>
<p>A data frame is the most similar structure in R to a standard spreadsheet.</p>
<p><img src="images/Data_frame_in_R.png" width="80%" style="display: block; margin: auto;" /> <br></p>
<p>We can generate a data frame from vectors of the same length using the <code>data.frame()</code> function. Let’s create a data frame containing information about Cambridge Students.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Create vectors that will become columns (all must be the same length)</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>sex <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;male&quot;</span>, <span class="st">&quot;female&quot;</span>, <span class="st">&quot;female&quot;</span>, <span class="st">&quot;male&quot;</span>, <span class="st">&quot;female&quot;</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>height_cm <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">175</span>, <span class="dv">165</span>, <span class="cn">NA</span>, <span class="dv">168</span>, <span class="dv">178</span>)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>college <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Wolfson&quot;</span>, <span class="st">&quot;Kings&quot;</span>, <span class="st">&quot;Lucy Cavendish&quot;</span>, <span class="st">&quot;St.Catherines&quot;</span>, <span class="st">&quot;Wolfson&quot;</span>)</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Combine vectors into a single data frame</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>students <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(sex, height_cm, college)</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Check the structure</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(students)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    5 obs. of  3 variables:
##  $ sex      : chr  &quot;male&quot; &quot;female&quot; &quot;female&quot; &quot;male&quot; ...
##  $ height_cm: num  175 165 NA 168 178
##  $ college  : chr  &quot;Wolfson&quot; &quot;Kings&quot; &quot;Lucy Cavendish&quot; &quot;St.Catherines&quot; ...</code></pre>
<p><br> <br></p>
<p><strong>Inspecting data frames</strong></p>
<p>In addition to <code>str</code>, there are many functions that can be used to inspect the data stored within a <code>data.frame</code>.</p>
<ul>
<li><code>dim()</code> = returns a vector in which the first element is the number of rows and the second element is the number of columns</li>
<li><code>nrow()</code> = returns the number of rows</li>
<li><code>ncol()</code> = returns the number of columns</li>
<li><code>head()</code> = displays all columns of the first 6 rows</li>
<li><code>tail()</code> = displays all columns of the last 6 rows</li>
<li><code>names()</code> or <code>colnames()</code> = returns the column names</li>
<li><code>rownames()</code> = returns the row names</li>
<li><code>summary()</code> = provides summary statistics for each column <br> <br></li>
</ul>
<p><strong>Indexing data frames</strong></p>
<p>We already learnt how to subset information from a vector by indexing. Now we are going to extend this to subsetting information from a data frame. The main difference here is that, unlike 1 dimensional vectors, data frames have 2 dimensions (the rows and columns). Hence, we need to provide two indices in our square brackets - <code>[row, column]</code>.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="do">## First element in the first column of the data frame</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>students[<span class="dv">1</span>, <span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [1] &quot;male&quot;</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Second element in the first column of the data frame</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>students[<span class="dv">2</span>, <span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [1] &quot;female&quot;</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Second element in the third column of the data frame</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>students[<span class="dv">2</span>, <span class="dv">3</span>]</span></code></pre></div>
<pre><code>## [1] &quot;Kings&quot;</code></pre>
<p>If we leave one of the indices empty, the default is to give us everything.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="do">## All elements in the second column of the data frame</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>students[, <span class="dv">2</span>]</span></code></pre></div>
<pre><code>## [1] 175 165  NA 168 178</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="do">## The first element in all columns of the data frame</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>students[<span class="dv">1</span>, ]</span></code></pre></div>
<pre><code>##    sex height_cm college
## 1 male       175 Wolfson</code></pre>
<p>As before, we can also exclude certain indices of the data frame using the “-” sign.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="do">## All columns except the third</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>students[, <span class="sc">-</span><span class="dv">3</span>]</span></code></pre></div>
<pre><code>##      sex height_cm
## 1   male       175
## 2 female       165
## 3 female        NA
## 4   male       168
## 5 female       178</code></pre>
<p>In addition to the indexing we saw with vectors, data frames can also be indexed using the column names directly:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Subset using column names as indices</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>students[, <span class="st">&quot;sex&quot;</span>]</span></code></pre></div>
<pre><code>## [1] &quot;male&quot;   &quot;female&quot; &quot;female&quot; &quot;male&quot;   &quot;female&quot;</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>students<span class="sc">$</span>sex</span></code></pre></div>
<pre><code>## [1] &quot;male&quot;   &quot;female&quot; &quot;female&quot; &quot;male&quot;   &quot;female&quot;</code></pre>
<p>One can use <code>&amp;</code> (and), <code>|</code> (or) and <code>!</code> (not) logical operators for complex subsetting, as we saw before for vectors.</p>
<hr />
</div>
<div id="matrices" class="section level2">
<h2>Matrices</h2>
<p>The final data structure we are going to meet in this workshop is a <strong>matrix</strong>. Like data frames, matrices are two dimensional - they have both rows and columns. Unlike data frames, however, matrices can only store one data type: <code>numeric</code>, <code>logical</code> or <code>character</code>. In that respect, matrices are more similar to a vector.</p>
<p>To generate a matrix we use the <code>matrix()</code> function. This function takes a vector of values (of any single data type) to populate the matrix with and the number of rows and columns that this should be divided into. The values are filled in column-by-column.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Create a 3x3 matrix containing the values 1 to 9</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>(example_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">3</span>))</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    4    7
## [2,]    2    5    8
## [3,]    3    6    9</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Create a 3x2 matrix containing the character values 1 to 6</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;one&quot;</span>, <span class="st">&quot;two&quot;</span>, <span class="st">&quot;three&quot;</span>, <span class="st">&quot;four&quot;</span>, <span class="st">&quot;five&quot;</span>, <span class="st">&quot;six&quot;</span>)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>(example_matrix_2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(values, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">3</span>))</span></code></pre></div>
<pre><code>##      [,1]    [,2]  
## [1,] &quot;one&quot;   &quot;four&quot;
## [2,] &quot;two&quot;   &quot;five&quot;
## [3,] &quot;three&quot; &quot;six&quot;</code></pre>
<p>A matrix can be indexed in the same way as a data frame, using <code>[row, col]</code>.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="do">## First element in the second column of a matrix</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>example_matrix[<span class="dv">1</span>, <span class="dv">2</span>]</span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<p>Matrices are commonly used in statistical analyses and modelling. If we have a data frame containing only numerical information and wish to convert this into a matrix we can do so using the <code>as.matrix()</code> function. <br></p>
<hr />
</div>
</div>
<div id="lesson-4-starting-with-data" class="section level1">
<h1>Lesson 4: Starting with data</h1>
<p>Objectives:</p>
<ol style="list-style-type: decimal">
<li>Upload data from a <code>.csv</code> file into a <code>data.frame</code> in R</li>
<li>Manipulate a <code>data.frame</code> by re-naming columns and rows and converting columns between data types</li>
<li>Be aware of different approaches to dealing with missing data</li>
<li>Export a <code>data.frame</code> from R into a <code>.csv</code> file</li>
</ol>
<hr />
<div id="the-use-case-data" class="section level2">
<h2>The use-case data</h2>
<p>For the remainder of this workshop we will be looking at real-life data from <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5544260/">Blackmore <em>et al</em>. (2017)</a>, <em>The effect of upper-respiratory infection on transcriptomic changes in the CNS</em>. In this study, mice were treated with either (i) Influenza A virus or (ii) control saline solution. At 0, 4 and 8 days post-treatment, samples were taken from the cerebellum (brain) and spinal cord tissues and the gene expression in these tissues was measured.</p>
<p>The dataset is stored as a <code>.csv</code> file. Each row holds information for a single RNA expression measurement and the columns include various attributes associated with this measurement. Examples include:</p>
<table>
<caption>Description of data stored in the first 11 columns of our use-case data</caption>
<colgroup>
<col width="11%" />
<col width="88%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Column</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">gene</td>
<td align="left">The name of the gene that was measured</td>
</tr>
<tr class="even">
<td align="left">sample</td>
<td align="left">The name of the sample that the gene expression was measured in</td>
</tr>
<tr class="odd">
<td align="left">expression</td>
<td align="left">The quantitative value of the gene expression</td>
</tr>
<tr class="even">
<td align="left">organism</td>
<td align="left">The organism/species - here all data were from mice</td>
</tr>
<tr class="odd">
<td align="left">age</td>
<td align="left">The age of the mouse - here all mice were 8 weeks</td>
</tr>
<tr class="even">
<td align="left">sex</td>
<td align="left">The sex of the mouse</td>
</tr>
<tr class="odd">
<td align="left">infection</td>
<td align="left">The infection state i.e., Influenze A or not infected (control)</td>
</tr>
<tr class="even">
<td align="left">strain</td>
<td align="left">The strain of mouse</td>
</tr>
<tr class="odd">
<td align="left">time</td>
<td align="left">The duration of infection (in days)</td>
</tr>
<tr class="even">
<td align="left">tissue</td>
<td align="left">The tissue that gene expression was measured in - either cerebellum or spinal cord</td>
</tr>
<tr class="odd">
<td align="left">mouse</td>
<td align="left">The mouse unique identifier</td>
</tr>
</tbody>
</table>
<hr />
</div>
<div id="downloading-and-importing-data" class="section level2">
<h2>Downloading and importing data</h2>
<p>There are two ways in which you can download the data required for this workshop. Firstly, we can use the <code>download.file()</code> function and pass it two arguments - the <code>url</code> where the data is stored and the <code>destfile</code> where we want to save it on our local system. Remember, when giving a file path to <code>destfile</code>, this can be absolute or relative. If you’re using a relative filepath, make sure you know where your working directory is (since this is where the path is relative to).</p>
<p>The second way to download this file would be to manually visit the <code>url</code> and save it into our desired file from there. Since we can do it all within R, let’s do it the first way.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Download data file into desired local destination</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(<span class="at">url =</span> <span class="st">&quot;https://github.com/carpentries-incubator/bioc-intro/raw/main/episodes/data/rnaseq.csv&quot;</span>,</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">destfile =</span> <span class="st">&quot;raw_data/rnaseq_data.csv&quot;</span>)</span></code></pre></div>
<p><br></p>
<p>Now that we have the file stored on our local system we can load the data into R. To do this we use the <code>read.csv()</code> function and pass the relative path to our file. Remember to assign the data to an object, here called <code>rna_data</code>. <br></p>
<ul>
<li><code>read.csv()</code> reads data from a comma-separated (CSV) file into a data frame</li>
<li><code>read.delim()</code> reads data from a delimited files (default is tab-delimited) into a data frame <br></li>
</ul>
<p>The <code>read.csv2()</code> and <code>read.delim2()</code> functions are designed for countries that use “,” as decimal places rather than separators. Here, the separators are typically “;”.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Load data into R as a data frame</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>rna_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">&quot;raw_data/rnaseq_data.csv&quot;</span>)</span></code></pre></div>
<p>As we expect, R does not give us any output from an assignment, but we should see that our data has now appeared in the RStudio environment.</p>
<hr />
</div>
<div id="checking-our-understanding" class="section level2">
<h2>Checking our understanding</h2>
<p>To bring together everything covered in the workshop so far, please complete the three challenges below.</p>
<p>Tips:</p>
<ul>
<li>Ask for help using the <code>?</code> or <code>??</code> notation</li>
<li>Be aware of missing data (NA values)</li>
<li>Remember the different properties of character vs. factor data types</li>
<li>Break each challenge down - think about what data you need and in what format <br> <br></li>
</ul>
<p><strong>Challenge: Basic plotting</strong><br />
Re-create this plot showing the expression of Ubfd1 at 8-days post-treatment in male and female mice. Think about which data is displayed on the graph - this is the data you need from our data frame. Explore the use of the <code>plot()</code> function.</p>
<p><img src="images/example_graph_challenge.png" width="70%" style="display: block; margin: auto;" /> <br> <br></p>
<p><strong>Challenge: Basic statistics</strong><br />
Using the <code>rna_data</code> data set, test whether the <code>expression</code> of Fbxl22 is correlated with <code>time</code>. Explore the use of the <code>cor.test</code> function.</p>
<ul>
<li>What is the estimated correlation coefficient?</li>
<li>What is the p-value?</li>
<li>What is the correlation coefficient confidence interval?</li>
</ul>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
